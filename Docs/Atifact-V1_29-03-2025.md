# ระบบสัมภาษณ์นักศึกษา (Student Interview System)

## ภาพรวมระบบ
ระบบสัมภาษณ์นักศึกษาถูกพัฒนาขึ้นเพื่อช่วยในการจัดการและเก็บข้อมูลการสัมภาษณ์นักศึกษา โดยมีการจำกัดสิทธิ์การเข้าถึงข้อมูลตามคณะ ระบบนี้ประกอบด้วยส่วนสำคัญดังนี้:

1. **ระบบล็อกอิน** - ใช้รหัสผู้สัมภาษณ์ในการเข้าสู่ระบบโดยไม่ต้องใช้รหัสผ่าน
2. **การจัดการนักศึกษา** - ระบบค้นหาและดูข้อมูลนักศึกษา
3. **การสัมภาษณ์** - บันทึกคำตอบการสัมภาษณ์นักศึกษา
4. **รายงานและการส่งออกข้อมูล** - ดูข้อมูลสรุปและส่งออกเป็นไฟล์ Excel
5. **การจำกัดสิทธิ์** - ผู้ใช้แต่ละคณะจะเข้าถึงได้เฉพาะข้อมูลของคณะตนเอง ยกเว้นผู้บริหารที่เข้าถึงได้ทั้งหมด

## เทคโนโลยีที่ใช้

### Frontend
- **Next.js** - JavaScript framework สำหรับสร้าง UI
- **React** - Library สำหรับสร้าง user interface
- **Tailwind CSS** - Framework CSS สำหรับการออกแบบ
- **Local Storage** - เก็บข้อมูลการล็อกอินในเบราว์เซอร์

### Backend
- **Node.js** - ใช้เป็น runtime environment
- **Express** - Web framework สำหรับสร้าง API
- **PostgreSQL** - ระบบฐานข้อมูล
- **ExcelJS** - ไลบรารีสำหรับสร้างไฟล์ Excel

## โครงสร้างโปรเจค

### Frontend
```
frontend/
  src/
    app/                  # Next.js app router
      api/                # API routes
        auth/
          login/          # API route สำหรับการล็อกอิน
      interview/          # หน้าสัมภาษณ์นักศึกษา
      interviews/         # หน้าดูประวัติการสัมภาษณ์
      login/              # หน้าล็อกอิน
      reports/            # หน้ารายงาน
    components/           # React components
    contexts/             # React contexts
      AuthContext.jsx     # จัดการสถานะการล็อกอิน
      InterviewContext.jsx # จัดการข้อมูลการสัมภาษณ์
    hooks/                # Custom React hooks
    services/             # บริการเรียก API
      api.js              # บริการพื้นฐานในการเรียก API
      questionService.js  # บริการเกี่ยวกับคำถาม
      studentService.js   # บริการเกี่ยวกับนักศึกษา
      interviewService.js # บริการเกี่ยวกับการสัมภาษณ์
```

### Backend
```
backend/
  config/             # การตั้งค่าต่างๆ
    db.js            # การเชื่อมต่อฐานข้อมูล
  controllers/        # Controllers สำหรับจัดการ logic
    interviewController.js
    questionController.js
    studentController.js
    interviewerController.js
  middleware/         # Middleware
    authMiddleware.js # ตรวจสอบสิทธิ์การเข้าถึง
  routes/             # API routes
    interviewRoutes.js
    questionRoutes.js
    studentRoutes.js
    interviewerRoutes.js
  uploads/            # โฟลเดอร์สำหรับเก็บไฟล์ชั่วคราว
  index.js            # จุดเริ่มต้นของแอปพลิเคชัน
```

## ฟีเจอร์หลัก

### 1. ระบบล็อกอิน
- ล็อกอินด้วยรหัสผู้สัมภาษณ์ (staff_id)
- จัดเก็บข้อมูลผู้ใช้ใน localStorage
- รองรับการจำกัดสิทธิ์ตามคณะ

### 2. การค้นหาและดูข้อมูลนักศึกษา
- ค้นหาตามรหัสนักศึกษา
- แสดงข้อมูลนักศึกษาโดยละเอียด
- กรองให้เห็นเฉพาะนักศึกษาในคณะของตนเอง (ยกเว้นผู้บริหาร)

### 3. การสัมภาษณ์นักศึกษา
- เลือกนักศึกษาที่ต้องการสัมภาษณ์
- แสดงแบบฟอร์มคำถามสำหรับการสัมภาษณ์
- บันทึกคำตอบและข้อมูลผู้สัมภาษณ์

### 4. การดูประวัติการสัมภาษณ์ (ยังไม่มีใน V1)
- แสดงรายการสัมภาษณ์ทั้งหมด (ตามสิทธิ์)
- ดูรายละเอียดการสัมภาษณ์รายบุคคล
- ค้นหาและกรองข้อมูลการสัมภาษณ์

### 5. รายงานและการส่งออกข้อมูล
- แสดงสถิติการสัมภาษณ์
- ส่งออกข้อมูลเป็นไฟล์ Excel
- พิมพ์รายงานการสัมภาษณ์รายบุคคล

## การจัดการด้านความปลอดภัย

### 1. การยืนยันตัวตน
- ตรวจสอบรหัสผู้สัมภาษณ์ (staff_id) กับฐานข้อมูล
- ส่งข้อมูลผู้ใช้ใน HTTP headers สำหรับการเรียก API

### 2. การจำกัดสิทธิ์ตามคณะ
- ผู้ใช้ทั่วไปเข้าถึงได้เฉพาะข้อมูลในคณะของตนเอง
- ผู้บริหารสามารถเข้าถึงข้อมูลทุกคณะได้
- ตรวจสอบสิทธิ์ทั้งที่ frontend และ backend

### 3. Defensive Programming
- ตรวจสอบข้อมูลนำเข้าก่อนดำเนินการ
- จัดการข้อผิดพลาดอย่างเหมาะสม
- ส่งคืนค่าที่มีรูปแบบสม่ำเสมอแม้เกิดข้อผิดพลาด

## ความท้าทายและการแก้ไข

### 1. การส่งตัวอักษรไทยใน HTTP Headers
**ปัญหา**: HTTP headers รองรับเฉพาะตัวอักษร ASCII และ ISO-8859-1 ทำให้ไม่สามารถส่งข้อมูลภาษาไทยได้
**การแก้ไข**: ส่งเฉพาะรหัสผู้ใช้ (staff_id) ใน headers และดึงข้อมูลอื่นๆ จากฐานข้อมูลที่ backend

### 2. การจัดการการล็อกอินและสถานะผู้ใช้
**ปัญหา**: สถานะการล็อกอินหายไปเมื่อรีเฟรชหน้า
**การแก้ไข**: จัดเก็บสถานะการล็อกอินใน localStorage และโหลดใหม่เมื่อเริ่มต้นแอปพลิเคชัน

### 3. การเข้าถึง API ที่ต้องการการยืนยันตัวตน
**ปัญหา**: API บางส่วนต้องการข้อมูลการยืนยันตัวตนแต่ยังไม่ได้ล็อกอิน
**การแก้ไข**: ตรวจสอบสถานะการล็อกอินก่อนเรียก API และ redirect ไปยังหน้าล็อกอินหากจำเป็น

### 4. ข้อผิดพลาดจากค่า Undefined
**ปัญหา**: เกิดข้อผิดพลาด "Cannot read properties of undefined"
**การแก้ไข**: เพิ่มการตรวจสอบค่า null และ undefined ก่อนเข้าถึงคุณสมบัติของออบเจ็กต์

## แผนพัฒนาในอนาคต

1. **ปรับปรุงระบบความปลอดภัย** - เพิ่มการล็อกอินด้วยรหัสผ่านและ session management
2. **พัฒนาระบบรายงานขั้นสูง** - เพิ่มกราฟและการวิเคราะห์ข้อมูลเชิงลึก
3. **เพิ่มการแจ้งเตือน** - แจ้งเตือนเมื่อมีการสัมภาษณ์ใหม่หรือมีข้อมูลที่ต้องดำเนินการ
4. **ระบบจัดการผู้ใช้** - เพิ่มความสามารถในการจัดการผู้ใช้และกำหนดสิทธิ์
5. **รองรับอุปกรณ์มือถือ** - ปรับปรุง UI/UX ให้รองรับการใช้งานบนอุปกรณ์มือถือได้ดียิ่งขึ้น

## สรุป
ระบบสัมภาษณ์นักศึกษานี้ได้รับการพัฒนาโดยใช้เทคโนโลยีทันสมัย มีการจัดการด้านความปลอดภัยและการจำกัดสิทธิ์ตามคณะ ทำให้สามารถใช้งานได้อย่างมีประสิทธิภาพในการเก็บข้อมูลและจัดการการสัมภาษณ์นักศึกษา ระบบได้รับการออกแบบให้ง่ายต่อการใช้งานและขยายฟีเจอร์ในอนาคต